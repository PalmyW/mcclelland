<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>McClelland Trophy Ladder 2025</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f9f9f9; color: #222; margin: 0; padding: 20px; }
        h1 { text-align: center; }
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
        th { background: #eee; }
        .note { text-align: center; color: #666; margin-bottom: 20px; }
    </style>
</head>
<body>
    <h1>McClelland Trophy Ladder 2025</h1>
    <div class="note">
        <p>Combined AFL & AFLW club rankings. <br>
        <small>Ranking: 1st = 18 points, 2nd = 17, ..., 18th = 1 point. Highest combined wins.</small></p>
    </div>
    <table id="ladder">
        <thead>
            <tr>
                <th>Club</th>
                <th>AFL Rank</th>
                <th>AFL Points</th>
                <th>AFLW Rank</th>
                <th>AFLW Points</th>
                <th>Combined Score</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
    <script>
    async function loadData() {
        const [aflRes, aflwRes] = await Promise.all([
            fetch('afl.json'),
            fetch('aflw.json')
        ]);
        const aflData = await aflRes.json();
        const aflwData = await aflwRes.json();

        // Build AFL rank map: team name -> {rank, points}
        const aflRankMap = {};
        aflData
            .sort((a, b) => b.points - a.points || b.percentage - a.percentage)
            .forEach((team, idx) => {
                aflRankMap[team.team] = {
                    rank: idx + 1,
                    points: 18 - idx // 1st = 18, 2nd = 17, ...
                };
            });

        // Build AFLW rank map: team name -> {rank, points}
        const aflwRankMap = {};
        aflwData
            .sort((a, b) => b.points - a.points || b.percentage - a.percentage)
            .forEach((team, idx) => {
                aflwRankMap[team.team] = {
                    rank: idx + 1,
                    points: 18 - idx
                };
            });

        // Get all unique clubs
        const allClubs = new Set([
            ...Object.keys(aflRankMap),
            ...Object.keys(aflwRankMap)
        ]);

        // Build combined ladder
        const combined = Array.from(allClubs).map(club => {
            const afl = aflRankMap[club] || {rank: '-', points: 0};
            const aflw = aflwRankMap[club] || {rank: '-', points: 0};
            return {
                club,
                aflRank: afl.rank,
                aflPoints: afl.points,
                aflwRank: aflw.rank,
                aflwPoints: aflw.points,
                combined: afl.points + aflw.points
            };
        });

        // Sort by combined score, then by AFL rank, then AFLW rank
        combined.sort((a, b) => {
            if (b.combined !== a.combined) return b.combined - a.combined;
            if (a.aflRank !== '-' && b.aflRank !== '-') return a.aflRank - b.aflRank;
            if (a.aflwRank !== '-' && b.aflwRank !== '-') return a.aflwRank - b.aflwRank;
            return 0;
        });

        // Render table
        const tbody = document.querySelector('#ladder tbody');
        tbody.innerHTML = '';
        combined.forEach(row => {
            tbody.innerHTML += `<tr>
                <td>${row.club}</td>
                <td>${row.aflRank}</td>
                <td>${row.aflPoints}</td>
                <td>${row.aflwRank}</td>
                <td>${row.aflwPoints}</td>
                <td><b>${row.combined}</b></td>
            </tr>`;
        });
    }
    loadData();
    </script>
</body>
</html>
